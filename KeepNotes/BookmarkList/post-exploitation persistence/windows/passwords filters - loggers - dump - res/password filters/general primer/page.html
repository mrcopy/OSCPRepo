<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>http://carnal0wnage.attackresearch.com/2013/09/stealing-passwords-every-time-they.html<br/>
<br/>
May be outdated, but the idea remains the same<br/>
<br/>
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms721882(v=vs.85).aspx">Password Filters</a>&nbsp; [0] are a way for organizations and governments to enforce stricter password requirements on Windows Accounts than those available by default in Active Directory Group Policy. &nbsp;It is also fairly documented on how to <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms721766(v=vs.85).aspx">Install and Register Password Filters</a>&nbsp;[1]. Basically what it boils down to is updating a registry key here: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages<br/>
<br/>
with the name of a DLL (without the extension) that you place in Windows\System32\<br/>
<br/>
For <a href="http://www.nationalccdc.org/">National CCDC</a>&nbsp;earlier this year (2013), I created an installer and "evil pass filter" that basically installed itself as a password filter and any time any passwords changed it would store the change to a log file locally to the victim (in clear text) as well as issue an HTTP basic auth POST to a server I own with the username and password.<br/>
<br/>
The full code can be found below. I'll leave the compiling up to you but basically its slamming the code in Visual Studio, telling it its a DLL, and clicking build for the architecture you are targeting (Make sure to use the Internet Open access settings that make the most sense for the environment you are using this in [2]).</body></html>