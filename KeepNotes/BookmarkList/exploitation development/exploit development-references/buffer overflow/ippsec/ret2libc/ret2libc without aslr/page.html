<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Ret2LibC Without ASLR</title>
</head><body>Without ASLR in the mix, Ret2LibC is quite a bit easier. Offsets are no longer needed, so only the actual address of LibC SYSTEM, EXIT, and /bin/sh are needed. <br/>
<br/>
These can be calculated pretty much the same way as with ASLR. <br/>
<br/>
<b>Finding LibC SYSTEM:</b><br/>
While debugging the program with gdb and peda:<br/>
(gdb) p system<br/>
<br/>
This will output the address similar to<br/>
$1 = {&lt;text variable, no debug info&gt;} 0xf7e4c060 &lt;system&gt;<br/>
<br/>
<b>Finding LibC EXIT:</b><br/>
While debugging the program with gdb and peda:<br/>
(gdb) p exit<br/>
<br/>
This will output the address similar to<br/>
$2 = {&lt;text variable, no debug info&gt;} 0xf7e3faf0 &lt;exit&gt;<br/>
<br/>
<b>Finding LibC /bin/sh:</b><br/>
While debugging the program with gdb and peda:<br/>
(gdb) find &amp;system,+99999999,"sh"<br/>
<br/>
More 'technical' way to ensure you're searching the right space. <br/>
gdb-peda$ <b>info proc map</b><br/>
process 8595<br/>
Mapped address spaces:<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Start Addr &nbsp; End Addr &nbsp; &nbsp; &nbsp; Size &nbsp; &nbsp; Offset objfile<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x400000 &nbsp; 0x429000 &nbsp; &nbsp;0x29000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 /bin/dash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x42a000 &nbsp; 0x42b000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp;0x29000 /bin/dash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x42b000 &nbsp; 0x42c000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp;0x2a000 /bin/dash<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x42c000 &nbsp; 0x42e000 &nbsp; &nbsp; 0x2000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 [heap]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7e08000 0xb7e09000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp; &nbsp; &nbsp;0x0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7e09000 0xb7fb9000 &nbsp; 0x1b0000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 /lib/i386-linux-gnu/libc-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fb9000 0xb7fbb000 &nbsp; &nbsp; 0x2000 &nbsp; 0x1af000 /lib/i386-linux-gnu/libc-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fbb000 0xb7fbc000 &nbsp; &nbsp; 0x1000 &nbsp; 0x1b1000 /lib/i386-linux-gnu/libc-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fbc000 0xb7fbf000 &nbsp; &nbsp; 0x3000 &nbsp; &nbsp; &nbsp; &nbsp;0x0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fd5000 0xb7fd6000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp; &nbsp; &nbsp;0x0<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fd6000 0xb7fd9000 &nbsp; &nbsp; 0x3000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 [vvar]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fd9000 0xb7fdb000 &nbsp; &nbsp; 0x2000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 [vdso]<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fdb000 0xb7ffe000 &nbsp; &nbsp;0x23000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 /lib/i386-linux-gnu/ld-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7ffe000 0xb7fff000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp;0x22000 /lib/i386-linux-gnu/ld-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xb7fff000 0xb8000000 &nbsp; &nbsp; 0x1000 &nbsp; &nbsp;0x23000 /lib/i386-linux-gnu/ld-2.23.so<br/>
&nbsp; &nbsp; &nbsp; &nbsp; 0xbffdf000 0xc0000000 &nbsp; &nbsp;0x21000 &nbsp; &nbsp; &nbsp; &nbsp;0x0 [stack]<br/>
<br/>
Now just search the address range of the libc library:<br/>
gdb-peda$ find "/bin/sh" 0xb7e09000 0xb7fbc000<br/>
Searching for '/bin/sh' in range: 0xb7e09000 - 0xb7fbc000<br/>
Found 1 results, display max 1 items:<br/>
libc : 0xb7f64a0b ("/bin/sh")<br/>
</body></html>