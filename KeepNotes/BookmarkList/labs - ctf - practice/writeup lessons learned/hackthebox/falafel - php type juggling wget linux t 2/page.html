<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Falafel - PHP Type Juggling WGET Linux Truncation Video</title>
</head><body>43745<br/>
<br/>
PHP<br/>
When PHP sees 0e, it converts it to a number because it thinks '0 exponent'<br/>
Works only if something like $num == 0e<br/>
Because PHP has a === function. <br/>
<br/>
Vulnerable versions of Wget will follow redirects in an unsafe fashion<br/>
<br/>
Able to truncate filenames to save unsafe file extensions<br/>
Linux filenames have a max length of 255 characters<br/>
This particular image upload truncated characters at 236. So name file A*232 + .php + .gif. <br/>
&nbsp;&#09;Satisfies the .gif extension for images<br/>
&nbsp;&#09;Will truncate to .php<br/>
&nbsp;&#09;= code execution<br/>
<br/>
Video linux group can dump the contents of the monitor (physical screen).<br/>
ls /dev/ | grep fb<br/>
fb0<br/>
<br/>
Grab resolution of screen <br/>
/sys/class/graphics/fb0:<br/>
bits_per_pixel<br/>
virtual_size<br/>
<br/>
<br/>
Grab fb0 and start analysis on it<br/>
File says it's a Targa image data, so open it with GIMP or other as "raw image data". Set resolution (virtual_size) according to those found above<br/>
<br/>
DISK group<br/>
Strings the disk and grep for files<br/>
debugfs /dev/sda&lt;#&gt;&#09;&#09;#drops into a psuedo terminal with raw access to the disk<br/>
<br/>
<br/>
</body></html>