<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>exe2hex cmd/ps/debug</title>
</head><body>g0tm1k has a very nice <a href="https://github.com/g0tmi1k/exe2hex">exe2hex.py</a>&nbsp; <br/>
<br/>
Overview<br/>
exe2hex encodes an executable binary file into ASCII text format.<br/>
<br/>
The result then can be transferred to the target machine (It is much easier to echo a ASCII file than binary data).<br/>
<br/>
Upon executing exe2hex's output file, the original program is restored by using DEBUG.exe or PowerShell (which are pre-installed by default on Windows).<br/>
<br/>
Can be automated by using either the in-built Telnet or WinEXE options in exe2hex to transfer the file over to the target machine, else the output can manually be inserted.<br/>
<br/>
Binary EXE -&gt; ASCII Text -&gt; *Transfer* -&gt; Binary EXE<br/>
<br/>
<br/>
<b>Quick Guide</b><br/>
Input using a file (-x /path/to/binary-program.exe) or STDIN (-s)<br/>
Output to BATch (-b file.bat) and/or PoSH (-p powershell.cmd)<br/>
<br/>
<br/>
<b>Example Usage</b><br/>
<br/>
Create BATch &amp; PowerShell files:<br/>
$ python3 exe2hex.py -x /usr/share/windows-binaries/sbd.exe<br/>
[*] exe2hex v1.5<br/>
[i] Outputting to /root/sbd.bat (BATch) and /root/sbd.cmd (PoSh)<br/>
[+] Successfully wrote (BATch) /root/sbd.bat<br/>
[+] Successfully wrote (PoSh) /root/sbd.cmd<br/>
$<br/>
<br/>
Compress the file before creating a BATch file:<br/>
$ ./exe2hex.py -x /usr/share/windows-binaries/nc.exe -b /var/www/html/nc.txt -cc<br/>
[*] exe2hex v1.5<br/>
[i] Attempting to clone and compress<br/>
[i] Creating temporary file /tmp/tmpft9tmm_i<br/>
[+] Compression (strip) was successful! (0.0% saved)<br/>
[+] Compression (UPX) was successful! (50.9% saved)<br/>
[+] Successfully wrote (BATch) /var/www/html/nc.txt<br/>
$<br/>
<br/>
Use STDIN to create BATch &amp; PowerShell files:<br/>
$ cat /usr/share/windows-binaries/whoami.exe | python3 exe2hex.py -s -b debug.bat -p ps.cmd<br/>
[*] exe2hex v1.5<br/>
[i] Reading from STDIN<br/>
[+] Successfully wrote (BATch) /root/debug.bat<br/>
[+] Successfully wrote (PoSh) /root/ps.cmd<br/>
$<br/>
<br/>
Help<br/>
$ python3 exe2hex.py<br/>
[*] exe2hex v1.5<br/>
<br/>
Encodes an executable binary file into ASCII text format<br/>
Restore using DEBUG.exe (BATch - x86) or PowerShell (PoSh - x86/x64)<br/>
<br/>
Quick Guide:<br/>
&nbsp;+ Input binary file with -s or -x<br/>
&nbsp;+ Output with -b and/or -p<br/>
Example:<br/>
&nbsp;$ /usr/bin/exe2hex -x /usr/share/windows-binaries/sbd.exe<br/>
&nbsp;$ /usr/bin/exe2hex -x /usr/share/windows-binaries/nc.exe -b /var/www/html/nc.txt -cc<br/>
&nbsp;$ cat /usr/share/windows-binaries/whoami.exe | /usr/bin/exe2hex -s -b debug.bat -p ps.cmd<br/>
<br/>
--- --- --- --- --- --- --- --- --- --- --- --- --- --- ---<br/>
<br/>
Usage: exe2hex [options]<br/>
<br/>
Options:<br/>
&nbsp; -h, --help &nbsp;show this help message and exit<br/>
&nbsp; -x EXE &nbsp; &nbsp; &nbsp;The EXE binary file to convert<br/>
&nbsp; -s &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Read from STDIN<br/>
&nbsp; -b BAT &nbsp; &nbsp; &nbsp;BAT output file (DEBUG.exe method - x86)<br/>
&nbsp; -p POSH &nbsp; &nbsp; PoSh output file (PowerShell method - x86/x64)<br/>
&nbsp; -e &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;URL encode the output<br/>
&nbsp; -r TEXT &nbsp; &nbsp; pRefix - text to add before the command on each line<br/>
&nbsp; -f TEXT &nbsp; &nbsp; suFfix - text to add after the command on each line<br/>
&nbsp; -l INT &nbsp; &nbsp; &nbsp;Maximum HEX values per line<br/>
&nbsp; -c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Clones and compress the file before converting (-cc for higher<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; compression)<br/>
&nbsp; -t &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Create a Expect file, to automate to a Telnet session.<br/>
&nbsp; -w &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Create a Expect file, to automate to a WinEXE session.<br/>
&nbsp; -v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Enable verbose mode<br/>
$<br/>
<br/>
<br/>
Kali-Linux<br/>
exe2hex is already packaged in Kali Rolling, so all you have to-do is:<br/>
<br/>
root@kali:~# apt install -y exe2hexbat</body></html>