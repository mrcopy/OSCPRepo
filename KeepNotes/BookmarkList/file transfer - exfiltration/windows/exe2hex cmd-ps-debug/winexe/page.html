<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WinEXE</title>
</head><body>WinEXE<br/>
Like the Telnet mode (-t), exe2hex can automate using winexe to transfer files across, inline, using expect:<br/>
<br/>
$ python3 exe2hex.py -x /usr/share/windows-binaries/mbenum/mbenum.exe -p mbenum.cmd -w<br/>
[*] exe2hex v1.5<br/>
[+] Successfully wrote (PoSh) /root/mbenum.cmd<br/>
[+] Successfully wrote (Expect) /root/mbenum-posh-winexe<br/>
$<br/>
$ expect /root/mbenum-posh-winexe<br/>
Usage: ./mbenum-posh-winexe &lt;ip&gt; &lt;username&gt; &lt;password&gt;<br/>
$<br/>
$ ./mbenum-posh-winexe 192.168.103.147 win7 123456789<br/>
<br/>
spawn winexe -U win7%123456789 //192.168.103.147 cmd.exe<br/>
<br/>
Microsoft Windows [Version 6.1.7601]<br/>
Copyright (c) 2009 Microsoft Corporation. &nbsp;All rights reserved.<br/>
<br/>
C:\Windows\system32&gt;cd %TEMP%<br/>
cd %TEMP%<br/>
<br/>
C:\Windows\Temp&gt;echo 656082.0&gt;mbenum.cmd<br/>
echo 656082.0&gt;mbenum.cmd<br/>
<br/>
C:\Windows\Temp&gt;type mbenum.cmd<br/>
type mbenum.cmd<br/>
656082.0<br/>
<br/>
[i] Writeable folder!<br/>
<br/>
<br/>
C:\Windows\Temp&gt;del /F mbenum.cmd<br/>
del /F mbenum.cmd<br/>
<br/>
C:\Windows\Temp&gt;echo|set /p=""&gt;mbenum.hex<br/>
<br/>
echo|set /p=""&gt;mbenum.hex<br/>
<br/>
C:\Windows\Temp&gt; &nbsp; (Progress: 1/388)<br/>
<br/>
C:\Windows\Temp&gt;echo|set /p="4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000e80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000"&gt;&gt;mbenum.hex<br/>
<br/>
echo|set /p="4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000e80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000"&gt;&gt;mbenum.hex<br/>
<br/>
C:\Windows\Temp&gt; &nbsp; (Progress: 2/388)<br/>
<br/>
C:\Windows\Temp&gt;echo|set /p="fa28c48dbe49aadebe49aadebe49aadec555a6debf49aaded156a1debf49aade3d55a4deae49aaded156a0de8b49aade3d41f7debb49aadebe49abde9049aadeb86aa0debc49aade52696368be49aade000000000000000000000000000000000000000000000000504500004c01030001ea7f3f0000000000000000e0000f01"&gt;&gt;mbenum.hex<br/>
<br/>
...SNIP...<br/>
<br/>
C:\Windows\Temp&gt; &nbsp; (Progress: 385/388)<br/>
<br/>
C:\Windows\Temp&gt;powershell -Command "$h=Get-Content -readcount 0 -path './mbenum.hex';$l=$h[0].length;$b=New-Object byte[] ($l/2);$x=0;for ($i=0;$i -le $l-1;$i+=2){$b[$x]=[byte]::Parse($h[0].Substring($i,2),[System.Globalization.NumberStyles]::HexNumber);$x+=1};set-content -encoding byte 'mbenum.exe' -value $b;Remove-Item -force mbenum.hex;Get-ChildItem mbenum.exe;"<br/>
<br/>
powershell -Command "$h=Get-Content -readcount 0 -path './mbenum.hex';$l=$h[0].length;$b=New-Object byte[] ($l/2);$x=0;for ($i=0;$i -le $l-1;$i+=2){$b[$x]=[byte]::Parse($h[0].Substring($i,2),[System.Globalization.NumberStyles]::HexNumber);$x+=1};set-content -encoding byte 'mbenum.exe' -value $b;Remove-Item -force mbenum.hex;Get-ChildItem mbenum.exe;"<br/>
<br/>
<br/>
&nbsp; &nbsp;(Progress: 386/388)ows\Temp<br/>
<br/>
<br/>
[i] Done<br/>
<br/>
<br/>
<br/>
Mode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LastWriteTime &nbsp; &nbsp; Length Name<br/>
---- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;------------- &nbsp; &nbsp; ------ ----<br/>
-a--- &nbsp; &nbsp; &nbsp; &nbsp;09/06/2017 &nbsp; &nbsp; 10:21 &nbsp; &nbsp; &nbsp;49152 mbenum.exe<br/>
<br/>
<br/>
<br/>
<br/>
C:\Windows\Temp&gt;<br/>
<br/>
NOTE: May need to press enter to get a prompt back at the end.</body></html>