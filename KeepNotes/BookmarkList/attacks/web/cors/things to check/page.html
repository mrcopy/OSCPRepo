<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Things To Check</title>
</head><body>To summarize, whether you’re defending your application or conducting a penetration test, here are a few things to check:<br/>
<ul><li><b>Does the server respond with a CORS policy?</b>&nbsp;If you’re testing in the context of Same-Origin, you should add the origin header to a request, e.g. with Burp Repeater. Start with an origin that is the same as the legitimate front-end app, rather than some random other hostname.</li>
<li><b>What permissions are exposed by the CORS policy?</b>&nbsp;Are they using cookies and allowing requests withCredentials? Or are they requiring a custom header or body parameter for authentication (both of which negate most attacks)?</li>
<li><b>What origins are allowed?</b>&nbsp;Is it reflecting any origin? Or is it just the legitimate application host? Or third-party hosting services e.g. CloudFront URLs?</li>
<li><b>Will other subdomains work?</b>&nbsp;And if so, are there any other assets included in that scope, other than the client application?</li>
<li>Does it look like they’re doing any sort of pattern matching for origin whitelisting? Is it possible to trick it with a partial match? E.g. if a trusted origin is https://secureideas.com, will insecureideas.com work? What about an overlapping top-level domain, like secureideas.community or secureideas.com.mx?</li>
<li><b>What about other domains owned by the same company?</b></li>
<li><b>What about the public IP address for the server?</b>&nbsp;If so, do other IPs work?</li>
<li><b>What about other port numbers on the host?</b>&nbsp;Could there be an attack vector via an administrative console or non-production environment?</li>
</ul>
<br/>
</body></html>