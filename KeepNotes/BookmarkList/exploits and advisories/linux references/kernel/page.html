<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Kernel</title>
</head><body>Dirty Cow, remember there are two types.../proc/self/mem and PTRACE_POKEDATA. PTRACE for CentOS. Know the differences (look at websites section, the link has a great table).<br/>
&nbsp;&#09;Personally linking FireFart because it's never let me down: https://github.com/FireFart/dirtycow/blob/master/dirty.c<br/>
<br/>
Needs work...<br/>
&nbsp;&#09;37722: espfixx64_NMI: db cannot be used in asm here compile error<br/>
&nbsp;&#09;39772: not in local exploitdb, check online for zip: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/39772.zip<br/>
&nbsp;&#09;40611 - Linux Kernel 2.6.22 &lt; 3.9 - 'Dirty COW' /proc/self/mem Race Condition (Write Access Method): requires file_name and new_contents. Possible to make irreversable changes...<br/>
&nbsp;&#09;40616 - Linux Kernel 2.6.22 &lt; 3.9 (x86/x64) - 'Dirty COW /proc/self/mem' Race Condition Privilege Escalation (SUID Method): will read /usr/bin/passwd, and back it up to /tmp/bak...not quite reliable...kernel panics and other<br/>
&nbsp;&#09;41995 - Linux Kernel 3.11 &lt; 4.8 0 - 'SO_SNDBUFFORCE' / 'SO_RCVBUFFORCE' Local Privilege Escalation: error in code, near initialization for ubuf_info_callback<br/>
&nbsp;&#09;43418 - Linux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege Escalation (KASLR / SMEP): errors when compiling...bad register...would need to edit<br/>
&nbsp;&#09;44325 - Linux Kernel &lt; 4.15.4 - 'show_floppy' KASLR Address Leak: did not work for target machine...<br/>
&nbsp;&#09;44298 - Linux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation: requires linux/bpf.h, not found on a few systems? exploit is probably fine, needed apt-get install gcc-multilib to compile with -m32<br/>
<br/>
<br/>
<br/>
Builds and runs out of the box<br/>
40871 - Linux Kernel 4.4.0 (Ubuntu 14.04/16.04 x86-64) - 'AF_PACKET' Race Condition Privilege Escalation: builds and races, but did not successfully exploit on target machine, still worth a try<br/>
41458 - Linux Kernel 4.4.0 (Ubuntu) - DCCP Double-Free Privilege Escalation: builds and runs, but did not successfully exploit on target machine, still worth a try<br/>
45010 - Linux Kernel &lt; &nbsp;4.13.9 (Ubuntu 16.04/Fedora 27) - Local Privilege Escalation: compiles and runs fine out of the box, but only works for specific systems<br/>
<br/>
<br/>
Golden exploits<br/>
9545.c&#09; &nbsp;- Linux Kernel 2.4.x/2.6.x (CentOS 4.8/5.3 / RHEL 4.8/5.3 / SuSE 10 SP2/11 / Ubuntu 8.10) (PPC) - 'sock_sendpage()' Local Privilege Escalation &#09;(may need -m32 --Wl,--hash-style=both)<br/>
15023.c &nbsp; &nbsp; - Linux Kernel &lt; 2.6.36-rc4-git2 (x86-64) - 'ia32syscall' Emulation Privilege Escalation <br/>
18411.c &nbsp;&#09; &nbsp;- Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64) - 'Mempodipper' Local Privilege Escalation (1)<br/>
40847.cpp - Linux Kernel 2.6.22 &lt; 3.9 - 'Dirty COW /proc/self/mem' Race Condition Privilege Escalation (/etc/passwd Method): works great! gives the option to drop directly into a shell or backup/overwrite the /etc/passwd file. requires complex compile, but works out of the box like a charm. Also on more kernels than searchsploit says.....(3.0.0-12-generic "kernel too old error", so trial and error")<br/>
37292.c &nbsp; &nbsp; - Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation<br/>
44298.c &nbsp; &nbsp; - Linux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation beautiful, simple, effective</body></html>