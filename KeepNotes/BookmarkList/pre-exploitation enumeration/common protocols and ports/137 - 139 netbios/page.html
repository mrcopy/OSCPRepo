<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>137 - 139: NetBIOS</title>
</head><body>nmblookup â€” NetBIOS over TCP/IP client used to lookup NetBIOS names<br/>
nbtscan<br/>
nbtscan $TARGET -R 54<br/>
nbtstat<br/>
<br/>
<br/>
<br/>
Netbios listens on TCP Port 139, 445 and UDP Port 137. <br/>
<br/>
How do we machines on which these three ports or a combination are open and feed that IP information to nbtscan and enum4linux. We can do this by using grep such as<br/>
grep -E "^Host.*[ ]137/open/udp" &lt;Nmap .gnmap file&gt; &nbsp; &nbsp; : Grep 137 UDP Ports to run nbtscan<br/>
grep -E "^Host.*[ ]139/open/tcp" &lt;Nmap .gnmap file&gt; &nbsp; &nbsp; <br/>
<br/>
#If we want that tcp port 139 and 445 both must be open<br/>
grep -E "^Host.*[ ]139/open/tcp" &lt;Nmap .gnmap file&gt; | grep -E "^Host.*[ ]445/open/tcp" &lt;Nmap .gnmap file&gt; : Grep TCP 135 and 445 port to run enum4linux<br/>
<br/>
#If we want that tcp port 139 or 445 must be open<br/>
grep -E "^Host.*[ ]139/open/tcp|[ ]443/open/tcp" &lt;Nmap .gnmap file&gt;<br/>
<br/>
NBTSCAN:<br/>
nbtscan<br/>
-v &nbsp; &nbsp; &nbsp; &nbsp;Verbose output. Print all names received from each host.<br/>
-f filename &nbsp; &nbsp; Take IP addresses to scan from file "filename"<br/>
<br/>
enum4linux: A Linux alternative to enum.exe for enumerating data from Windows and Samba hosts. It is is basically a wrapper around the Samba tools smbclient, rpclient, net and nmblookup. A very good usage guide is here<br/>
enum4linux -a 192.168.2.55 &nbsp;: enumerate all the information it can from a remote host</body></html>